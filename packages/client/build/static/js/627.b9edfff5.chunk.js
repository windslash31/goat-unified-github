/*! For license information please see 627.b9edfff5.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkemployee_access_dashboard=self.webpackChunkemployee_access_dashboard||[]).push([[627],{627:(e,t,s)=>{s.r(t),s.d(t,{EmployeeDetailPage:()=>I});var a=s(1882),i=s(2176),r=s(4571),o=s(624),l=s(7993),n=s(4032),c=s(8119);const d=(0,c.A)("BookLock",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H10",key:"18wgow"}],["path",{d:"M20 15v7H6.5a2.5 2.5 0 0 1 0-5H20",key:"dpch1j"}],["rect",{width:"8",height:"5",x:"12",y:"6",rx:"1",key:"9nqwug"}],["path",{d:"M18 6V4a2 2 0 1 0-4 0v2",key:"1aquzs"}]]);var m=s(9869),p=s(9644),x=s(414),h=s(2841),u=s(2758),g=s(8898),y=s(8596),f=s(3442),v=s(7419),j=s(3985),_=s(9889),S=s(4971),b=s(2304);const A=(0,c.A)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var k=s(812);const E={google:"Google Workspace",jumpcloud:"JumpCloud",slack:"Slack",atlassian:"Atlassian (Jira/Confluence)"},N=e=>{let{status:t}=e;switch(t){case"Licensed":case"Active":return(0,k.jsx)(S.A,{className:"w-5 h-5 text-green-500"});case"Not Licensed":case"Suspended":case"Deactivated":case"Inactive":return(0,k.jsx)(b.A,{className:"w-5 h-5 text-red-500"});case"Error":return(0,k.jsx)(x.A,{className:"w-5 h-5 text-yellow-500"});default:return(0,k.jsx)(A,{className:"w-5 h-5 text-gray-400"})}},T=e=>{let{platform:t,license:s}=e;return(0,k.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(N,{status:s.status}),(0,k.jsxs)("div",{className:"ml-3",children:[(0,k.jsx)("p",{className:"font-semibold text-gray-800 dark:text-gray-200",children:E[t]}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.status})]})]}),s.details&&Object.keys(s.details).length>0&&(0,k.jsxs)("div",{className:"text-right text-sm",children:[s.details.is_guest&&(0,k.jsx)("span",{className:"font-medium text-blue-500",children:"Guest Account"}),s.details.products&&s.details.products.map(e=>(0,k.jsx)("div",{className:"text-gray-500",children:e},e)),Array.isArray(s.details)&&s.details.map(e=>(0,k.jsx)("div",{className:"text-gray-500",children:e.plan},e.sku))]})]})},w=e=>{let{employeeId:t}=e;const{data:s,isLoading:a,error:i}=(0,j.I)({queryKey:["employeeLicenses",t],queryFn:()=>(async e=>{const{data:t}=await _.A.get("/api/employees/".concat(e,"/licenses"));return t})(t)});return a?(0,k.jsx)("div",{className:"text-center p-6",children:"Loading license details..."}):i?(0,k.jsx)("div",{className:"text-center p-6 text-red-500",children:"Could not fetch license details."}):(0,k.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,k.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,k.jsx)(T,{platform:e.platform,license:e},e.platform))})})};var C=s(994),L=s(7507),P=s(1259),O=s(4079),R=s(8146),D=s(5798);const I=e=>{let{onEdit:t,onDeactivate:s,permissions:c,onLogout:j}=e;const{employeeId:_}=(0,r.g)(),S=(0,r.Zp)(),{setDynamicCrumbs:b}=(0,u.r)(),[A,E]=(0,i.useState)(null),[N,T]=(0,i.useState)(!0),[I,H]=(0,i.useState)(null),[z,B]=(0,i.useState)("details"),[U,F]=(0,i.useState)([]),[K,W]=(0,i.useState)(!0),[M,V]=(0,i.useState)(!1),q=(0,i.useRef)(null),J=(0,D.U)("(min-width: 768px)"),[G,Z]=(0,i.useState)({timeline:{data:[],loading:!1,error:null,fetched:!1}}),[Q,X]=(0,i.useState)(!1),[Y,$]=(0,i.useState)(null),ee=[{id:"details",label:"Details",icon:(0,k.jsx)(o.A,{size:16}),permission:!0},{id:"devices",label:"Devices",icon:(0,k.jsx)(l.A,{size:16}),permission:!0},{id:"platforms",label:"Apps & Platforms",shortLabel:"Access",icon:(0,k.jsx)(n.A,{size:16}),permission:!0},{id:"licenses",label:"Licenses",icon:(0,k.jsx)(d,{size:16}),permission:!0},{id:"platform-logs",label:"Platform Logs",shortLabel:"Logs",icon:(0,k.jsx)(m.A,{size:16}),permission:c.includes("log:read:platform")},{id:"timeline",label:"Unified Timeline",shortLabel:"Timeline",icon:(0,k.jsx)(p.A,{size:16}),permission:c.includes("log:read:platform")}].filter(e=>e.permission),te=J?ee:ee.slice(0,3),se=J?[]:ee.slice(3),ae=se.some(e=>e.id===z);(0,i.useEffect)(()=>{const e=e=>{q.current&&!q.current.contains(e.target)&&V(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const ie=(0,i.useCallback)(()=>{const e=localStorage.getItem("accessToken");e?(T(!0),fetch("".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE_URL,"/api/employees/").concat(_),{headers:{Authorization:"Bearer ".concat(e)}}).then(e=>{if(404===e.status)throw new Error("Employee not found.");if(!e.ok)throw new Error("Failed to fetch employee profile.");return e.json()}).then(e=>{E(e);const t=[e.first_name,e.middle_name,e.last_name].filter(Boolean).join(" ");b([{name:"Employees",path:"/employees"},{name:t,path:"/employees/".concat(_)}])}).catch(e=>{console.error("Error fetching main employee data:",e),H(e.message)}).finally(()=>T(!1)),W(!0),fetch("".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE_URL,"/api/employees/").concat(_,"/platform-statuses"),{headers:{Authorization:"Bearer ".concat(e)}}).then(e=>e.ok?e.json():[]).then(e=>F(e)).catch(e=>console.error("Failed to fetch platform statuses:",e)).finally(()=>W(!1))):j()},[_,j,b]);(0,i.useEffect)(()=>{ie();const e=localStorage.getItem("accessToken");return e&&_&&fetch("".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE_URL,"/api/employees/logs/view"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({targetEmployeeId:_})}).catch(e=>console.error("Failed to log profile view:",e)),()=>{b([])}},[ie,b,_]);const re=(0,i.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!_||!c.includes("log:read:platform")||!e&&(G.timeline.fetched||G.timeline.loading))return;const t=localStorage.getItem("accessToken");let s="".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE_URL,"/api/employees/").concat(_,"/unified-timeline");Z(e=>(0,a.A)((0,a.A)({},e),{},{timeline:(0,a.A)((0,a.A)({},e.timeline),{},{loading:!0})})),fetch(s,{headers:{Authorization:"Bearer ".concat(t)}}).then(e=>e.ok?e.json():e.json().then(e=>Promise.reject(e))).then(e=>{Z(t=>(0,a.A)((0,a.A)({},t),{},{timeline:{data:e,loading:!1,error:null,fetched:!0}}))}).catch(e=>{Z(t=>(0,a.A)((0,a.A)({},t),{},{timeline:{data:[],loading:!1,error:e.message,fetched:!0}}))})},[_,c,G.timeline]),oe=e=>{B(e),V(!1),"timeline"===e&&re()},le=e=>{e&&($(e),X(!0))},ne=e=>{let{id:t,label:s,shortLabel:a,icon:i}=e;return(0,k.jsxs)("button",{onClick:()=>oe(t),className:"flex-shrink-0 flex items-center gap-2 py-3 px-4 border-b-2 font-semibold text-sm transition-colors whitespace-nowrap ".concat(z===t?"border-kredivo-primary text-kredivo-primary":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"),children:[i," ",J?s:a||s]})},ce=(0,k.jsxs)("div",{className:"mt-6",children:["details"===z&&(0,k.jsx)(y.g,{employee:A,navigate:S,permissions:c,onTicketClick:le}),"devices"===z&&(0,k.jsx)(P.v,{employeeId:_}),"platforms"===z&&(0,k.jsx)(f.z,{applications:A.applications||[],platformStatuses:U,isLoading:K,onTicketClick:le}),"licenses"===z&&(0,k.jsx)(w,{employeeId:_}),"platform-logs"===z&&(0,k.jsx)(L.v,{employeeId:_,onLogout:j}),"timeline"===z&&(0,k.jsx)(C.n,{events:G.timeline.data,loading:G.timeline.loading,error:G.timeline.error})]});return N?(0,k.jsx)("div",{className:"p-6 text-center",children:"Loading employee profile..."}):I?(0,k.jsxs)("div",{className:"p-6 text-center text-red-500",children:[(0,k.jsx)(x.A,{className:"mx-auto w-12 h-12 mb-4"})," ",(0,k.jsx)("h2",{className:"text-xl font-semibold",children:"Could not load employee data"})," ",(0,k.jsx)("p",{children:I})," "]}):A?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{className:"p-4 sm:p-6 space-y-6",children:[(0,k.jsx)(g.Z,{employee:A,onEdit:t,onDeactivate:s,permissions:c,isOwnProfile:!1}),(0,k.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsx)("nav",{className:"-mb-px flex items-center overflow-x-auto","aria-label":"Tabs",children:te.map(e=>(0,k.jsx)(ne,(0,a.A)({},e),e.id))}),se.length>0&&(0,k.jsxs)("div",{ref:q,className:"relative ml-auto pl-2",children:[(0,k.jsxs)("button",{onClick:()=>V(e=>!e),className:"flex-shrink-0 flex items-center gap-2 py-3 px-4 border-b-2 font-semibold text-sm transition-colors whitespace-nowrap ".concat(ae?"border-kredivo-primary text-kredivo-primary":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"),children:[(0,k.jsx)(h.A,{size:16})," More"]}),(0,k.jsx)(O.N,{children:M&&(0,k.jsx)(R.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"origin-top-right absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white dark:bg-gray-800 ring-1 ring-black ring-opacity-5 focus:outline-none z-10",children:(0,k.jsx)("div",{className:"py-1",children:se.map(e=>(0,k.jsxs)("button",{onClick:()=>oe(e.id),className:"w-full text-left flex items-center gap-3 px-4 py-2 text-sm ".concat(z===e.id?"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"),children:[e.icon," ",e.shortLabel||e.label]},e.id))})})})]})]})}),ce]}),Q&&(0,k.jsx)(v.S,{ticketId:Y,onClose:()=>X(!1)})]}):null}}}]);
//# sourceMappingURL=627.b9edfff5.chunk.js.map